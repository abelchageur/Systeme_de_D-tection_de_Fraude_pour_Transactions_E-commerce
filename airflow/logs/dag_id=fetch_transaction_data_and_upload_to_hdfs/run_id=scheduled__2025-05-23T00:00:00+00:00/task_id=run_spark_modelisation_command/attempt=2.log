[2025-05-24T20:36:43.825+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: fetch_transaction_data_and_upload_to_hdfs.run_spark_modelisation_command scheduled__2025-05-23T00:00:00+00:00 [queued]>
[2025-05-24T20:36:43.837+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: fetch_transaction_data_and_upload_to_hdfs.run_spark_modelisation_command scheduled__2025-05-23T00:00:00+00:00 [queued]>
[2025-05-24T20:36:43.837+0000] {taskinstance.py:1361} INFO - Starting attempt 2 of 2
[2025-05-24T20:36:43.852+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): run_spark_modelisation_command> on 2025-05-23 00:00:00+00:00
[2025-05-24T20:36:43.866+0000] {standard_task_runner.py:57} INFO - Started process 813 to run task
[2025-05-24T20:36:43.871+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'fetch_transaction_data_and_upload_to_hdfs', 'run_spark_modelisation_command', 'scheduled__2025-05-23T00:00:00+00:00', '--job-id', '15', '--raw', '--subdir', 'DAGS_FOLDER/ETL.py', '--cfg-path', '/tmp/tmppeft57r7']
[2025-05-24T20:36:43.875+0000] {standard_task_runner.py:85} INFO - Job 15: Subtask run_spark_modelisation_command
[2025-05-24T20:36:43.955+0000] {task_command.py:415} INFO - Running <TaskInstance: fetch_transaction_data_and_upload_to_hdfs.run_spark_modelisation_command scheduled__2025-05-23T00:00:00+00:00 [running]> on host b7cf5396f9f1
[2025-05-24T20:36:44.060+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='fetch_transaction_data_and_upload_to_hdfs' AIRFLOW_CTX_TASK_ID='run_spark_modelisation_command' AIRFLOW_CTX_EXECUTION_DATE='2025-05-23T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-05-23T00:00:00+00:00'
[2025-05-24T20:36:44.062+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-05-24T20:36:44.063+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'docker exec spark-master python3 modelisation.py']
[2025-05-24T20:36:44.082+0000] {subprocess.py:86} INFO - Output:
[2025-05-24T20:36:47.466+0000] {subprocess.py:93} INFO - Setting default log level to "WARN".
[2025-05-24T20:36:47.467+0000] {subprocess.py:93} INFO - To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
[2025-05-24T20:36:47.927+0000] {subprocess.py:93} INFO - 25/05/24 20:36:47 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[2025-05-24T20:36:49.154+0000] {local_task_job_runner.py:115} ERROR - Received SIGTERM. Terminating subprocesses
[2025-05-24T20:36:49.200+0000] {process_utils.py:131} INFO - Sending 15 to group 813. PIDs of all processes in the group: [814, 813]
[2025-05-24T20:36:49.228+0000] {process_utils.py:86} INFO - Sending the signal 15 to group 813
[2025-05-24T20:36:49.247+0000] {taskinstance.py:1632} ERROR - Received SIGTERM. Terminating subprocesses.
[2025-05-24T20:36:49.248+0000] {subprocess.py:104} INFO - Sending SIGTERM signal to process group
[2025-05-24T22:01:54.864+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: fetch_transaction_data_and_upload_to_hdfs.run_spark_modelisation_command scheduled__2025-05-23T00:00:00+00:00 [queued]>
[2025-05-24T22:01:54.875+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: fetch_transaction_data_and_upload_to_hdfs.run_spark_modelisation_command scheduled__2025-05-23T00:00:00+00:00 [queued]>
[2025-05-24T22:01:54.876+0000] {taskinstance.py:1361} INFO - Starting attempt 2 of 2
[2025-05-24T22:01:54.891+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): run_spark_modelisation_command> on 2025-05-23 00:00:00+00:00
[2025-05-24T22:01:54.902+0000] {standard_task_runner.py:57} INFO - Started process 385 to run task
[2025-05-24T22:01:54.905+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'fetch_transaction_data_and_upload_to_hdfs', 'run_spark_modelisation_command', 'scheduled__2025-05-23T00:00:00+00:00', '--job-id', '13', '--raw', '--subdir', 'DAGS_FOLDER/ETL.py', '--cfg-path', '/tmp/tmp0g98vnyj']
[2025-05-24T22:01:54.909+0000] {standard_task_runner.py:85} INFO - Job 13: Subtask run_spark_modelisation_command
[2025-05-24T22:01:54.971+0000] {task_command.py:415} INFO - Running <TaskInstance: fetch_transaction_data_and_upload_to_hdfs.run_spark_modelisation_command scheduled__2025-05-23T00:00:00+00:00 [running]> on host 65b298c9af88
[2025-05-24T22:01:55.065+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='fetch_transaction_data_and_upload_to_hdfs' AIRFLOW_CTX_TASK_ID='run_spark_modelisation_command' AIRFLOW_CTX_EXECUTION_DATE='2025-05-23T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-05-23T00:00:00+00:00'
[2025-05-24T22:01:55.067+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-05-24T22:01:55.069+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'docker exec spark-master python3 modelisation.py']
[2025-05-24T22:01:55.087+0000] {subprocess.py:86} INFO - Output:
[2025-05-24T22:01:57.683+0000] {subprocess.py:93} INFO - Setting default log level to "WARN".
[2025-05-24T22:01:57.697+0000] {subprocess.py:93} INFO - To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
[2025-05-24T22:01:58.150+0000] {subprocess.py:93} INFO - 25/05/24 22:01:58 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[2025-05-24T22:02:03.708+0000] {subprocess.py:93} INFO - 25/05/24 22:02:03 WARN CSVHeaderChecker: CSV header does not conform to the schema.
[2025-05-24T22:02:03.708+0000] {subprocess.py:93} INFO -  Header: Transaction ID, Customer ID, Transaction Amount, Transaction Date, Payment Method, Product Category, Quantity, Customer Age, Customer Location, Device Used, IP Address, Shipping Address, Billing Address, Is Fraudulent, Account Age Days, Transaction Hour
[2025-05-24T22:02:03.709+0000] {subprocess.py:93} INFO -  Schema: Transaction_ID, Customer_ID, Transaction_Amount, Transaction_Date, Payment_Method, Product_Category, Quantity, Customer_Age, Customer_Location, Device_Used, IP_Address, Shipping_Address, Billing_Address, Is_Fraudulent, Account_Age_Days, Transaction_Hour
[2025-05-24T22:02:03.710+0000] {subprocess.py:93} INFO - Expected: Transaction_ID but found: Transaction ID
[2025-05-24T22:02:03.710+0000] {subprocess.py:93} INFO - CSV file: hdfs://namenode:9000/user/root/transactions/YYYY=2025/MM=05/DD=24/transaction_data.csv
[2025-05-24T22:02:05.527+0000] {subprocess.py:93} INFO - [Stage 0:>                                                          (0 + 1) / 1]                                                                                25/05/24 22:02:05 WARN CSVHeaderChecker: CSV header does not conform to the schema.
[2025-05-24T22:02:05.529+0000] {subprocess.py:93} INFO -  Header: Transaction ID, Customer ID, Transaction Amount, Transaction Date, Payment Method, Product Category, Quantity, Customer Age, Customer Location, Device Used, IP Address, Shipping Address, Billing Address, Is Fraudulent, Account Age Days, Transaction Hour
[2025-05-24T22:02:05.530+0000] {subprocess.py:93} INFO -  Schema: Transaction_ID, Customer_ID, Transaction_Amount, Transaction_Date, Payment_Method, Product_Category, Quantity, Customer_Age, Customer_Location, Device_Used, IP_Address, Shipping_Address, Billing_Address, Is_Fraudulent, Account_Age_Days, Transaction_Hour
[2025-05-24T22:02:05.531+0000] {subprocess.py:93} INFO - Expected: Transaction_ID but found: Transaction ID
[2025-05-24T22:02:05.532+0000] {subprocess.py:93} INFO - CSV file: hdfs://namenode:9000/user/root/transactions/YYYY=2025/MM=05/DD=24/transaction_data.csv
[2025-05-24T22:02:05.599+0000] {subprocess.py:93} INFO - 25/05/24 22:02:05 WARN CSVHeaderChecker: CSV header does not conform to the schema.
[2025-05-24T22:02:05.600+0000] {subprocess.py:93} INFO -  Header: Transaction ID, Customer ID, Transaction Amount, Transaction Date, Payment Method, Product Category, Quantity, Customer Age, Customer Location, Device Used, IP Address, Shipping Address, Billing Address, Is Fraudulent, Account Age Days, Transaction Hour
[2025-05-24T22:02:05.601+0000] {subprocess.py:93} INFO -  Schema: Transaction_ID, Customer_ID, Transaction_Amount, Transaction_Date, Payment_Method, Product_Category, Quantity, Customer_Age, Customer_Location, Device_Used, IP_Address, Shipping_Address, Billing_Address, Is_Fraudulent, Account_Age_Days, Transaction_Hour
[2025-05-24T22:02:05.602+0000] {subprocess.py:93} INFO - Expected: Transaction_ID but found: Transaction ID
[2025-05-24T22:02:05.603+0000] {subprocess.py:93} INFO - CSV file: hdfs://namenode:9000/user/root/transactions/YYYY=2025/MM=05/DD=24/transaction_data.csv
[2025-05-24T22:02:05.678+0000] {subprocess.py:93} INFO - 25/05/24 22:02:05 WARN CSVHeaderChecker: CSV header does not conform to the schema.
[2025-05-24T22:02:05.681+0000] {subprocess.py:93} INFO -  Header: Transaction ID, Customer ID, Transaction Amount, Transaction Date, Payment Method, Product Category, Quantity, Customer Age, Customer Location, Device Used, IP Address, Shipping Address, Billing Address, Is Fraudulent, Account Age Days, Transaction Hour
[2025-05-24T22:02:05.682+0000] {subprocess.py:93} INFO -  Schema: Transaction_ID, Customer_ID, Transaction_Amount, Transaction_Date, Payment_Method, Product_Category, Quantity, Customer_Age, Customer_Location, Device_Used, IP_Address, Shipping_Address, Billing_Address, Is_Fraudulent, Account_Age_Days, Transaction_Hour
[2025-05-24T22:02:05.683+0000] {subprocess.py:93} INFO - Expected: Transaction_ID but found: Transaction ID
[2025-05-24T22:02:05.683+0000] {subprocess.py:93} INFO - CSV file: hdfs://namenode:9000/user/root/transactions/YYYY=2025/MM=05/DD=24/transaction_data.csv
[2025-05-24T22:02:06.587+0000] {subprocess.py:93} INFO - 25/05/24 22:02:06 WARN CSVHeaderChecker: CSV header does not conform to the schema.
[2025-05-24T22:02:06.588+0000] {subprocess.py:93} INFO -  Header: Transaction ID, Customer ID, Transaction Amount, Transaction Date, Payment Method, Product Category, Quantity, Customer Age, Customer Location, Device Used, IP Address, Shipping Address, Billing Address, Is Fraudulent, Account Age Days, Transaction Hour
[2025-05-24T22:02:06.589+0000] {subprocess.py:93} INFO -  Schema: Transaction_ID, Customer_ID, Transaction_Amount, Transaction_Date, Payment_Method, Product_Category, Quantity, Customer_Age, Customer_Location, Device_Used, IP_Address, Shipping_Address, Billing_Address, Is_Fraudulent, Account_Age_Days, Transaction_Hour
[2025-05-24T22:02:06.589+0000] {subprocess.py:93} INFO - Expected: Transaction_ID but found: Transaction ID
[2025-05-24T22:02:06.590+0000] {subprocess.py:93} INFO - CSV file: hdfs://namenode:9000/user/root/transactions/YYYY=2025/MM=05/DD=24/transaction_data.csv
[2025-05-24T22:02:08.574+0000] {subprocess.py:93} INFO - [Stage 12:>                                                         (0 + 1) / 1]                                                                                [Stage 13:>                                                         (0 + 1) / 1]25/05/24 22:02:08 WARN CSVHeaderChecker: CSV header does not conform to the schema.
[2025-05-24T22:02:08.575+0000] {subprocess.py:93} INFO -  Header: Transaction ID, Customer ID, Transaction Amount, Transaction Date, Payment Method, Product Category, Quantity, Customer Age, Customer Location, Device Used, IP Address, Shipping Address, Billing Address, Is Fraudulent, Account Age Days, Transaction Hour
[2025-05-24T22:02:08.576+0000] {subprocess.py:93} INFO -  Schema: Transaction_ID, Customer_ID, Transaction_Amount, Transaction_Date, Payment_Method, Product_Category, Quantity, Customer_Age, Customer_Location, Device_Used, IP_Address, Shipping_Address, Billing_Address, Is_Fraudulent, Account_Age_Days, Transaction_Hour
[2025-05-24T22:02:08.576+0000] {subprocess.py:93} INFO - Expected: Transaction_ID but found: Transaction ID
[2025-05-24T22:02:08.577+0000] {subprocess.py:93} INFO - CSV file: hdfs://namenode:9000/user/root/transactions/YYYY=2025/MM=05/DD=24/transaction_data.csv
[2025-05-24T22:02:09.659+0000] {subprocess.py:93} INFO -                                                                                 25/05/24 22:02:09 WARN CSVHeaderChecker: CSV header does not conform to the schema.
[2025-05-24T22:02:09.660+0000] {subprocess.py:93} INFO -  Header: Transaction ID, Customer ID, Transaction Amount, Transaction Date, Payment Method, Product Category, Quantity, Customer Age, Customer Location, Device Used, IP Address, Shipping Address, Billing Address, Is Fraudulent, Account Age Days, Transaction Hour
[2025-05-24T22:02:09.661+0000] {subprocess.py:93} INFO -  Schema: Transaction_ID, Customer_ID, Transaction_Amount, Transaction_Date, Payment_Method, Product_Category, Quantity, Customer_Age, Customer_Location, Device_Used, IP_Address, Shipping_Address, Billing_Address, Is_Fraudulent, Account_Age_Days, Transaction_Hour
[2025-05-24T22:02:09.661+0000] {subprocess.py:93} INFO - Expected: Transaction_ID but found: Transaction ID
[2025-05-24T22:02:09.662+0000] {subprocess.py:93} INFO - CSV file: hdfs://namenode:9000/user/root/transactions/YYYY=2025/MM=05/DD=24/transaction_data.csv
[2025-05-24T22:02:08.146+0000] {subprocess.py:93} INFO - 25/05/24 22:02:08 WARN CSVHeaderChecker: CSV header does not conform to the schema.
[2025-05-24T22:02:08.147+0000] {subprocess.py:93} INFO -  Header: Transaction ID, Customer ID, Transaction Amount, Transaction Date, Payment Method, Product Category, Quantity, Customer Age, Customer Location, Device Used, IP Address, Shipping Address, Billing Address, Is Fraudulent, Account Age Days, Transaction Hour
[2025-05-24T22:02:08.148+0000] {subprocess.py:93} INFO -  Schema: Transaction_ID, Customer_ID, Transaction_Amount, Transaction_Date, Payment_Method, Product_Category, Quantity, Customer_Age, Customer_Location, Device_Used, IP_Address, Shipping_Address, Billing_Address, Is_Fraudulent, Account_Age_Days, Transaction_Hour
[2025-05-24T22:02:08.148+0000] {subprocess.py:93} INFO - Expected: Transaction_ID but found: Transaction ID
[2025-05-24T22:02:08.149+0000] {subprocess.py:93} INFO - CSV file: hdfs://namenode:9000/user/root/transactions/YYYY=2025/MM=05/DD=24/transaction_data.csv
[2025-05-24T22:02:08.638+0000] {subprocess.py:93} INFO - 25/05/24 22:02:08 WARN CSVHeaderChecker: CSV header does not conform to the schema.
[2025-05-24T22:02:08.639+0000] {subprocess.py:93} INFO -  Header: Transaction ID, Customer ID, Transaction Amount, Transaction Date, Payment Method, Product Category, Quantity, Customer Age, Customer Location, Device Used, IP Address, Shipping Address, Billing Address, Is Fraudulent, Account Age Days, Transaction Hour
[2025-05-24T22:02:08.640+0000] {subprocess.py:93} INFO -  Schema: Transaction_ID, Customer_ID, Transaction_Amount, Transaction_Date, Payment_Method, Product_Category, Quantity, Customer_Age, Customer_Location, Device_Used, IP_Address, Shipping_Address, Billing_Address, Is_Fraudulent, Account_Age_Days, Transaction_Hour
[2025-05-24T22:02:08.640+0000] {subprocess.py:93} INFO - Expected: Transaction_ID but found: Transaction ID
[2025-05-24T22:02:08.641+0000] {subprocess.py:93} INFO - CSV file: hdfs://namenode:9000/user/root/transactions/YYYY=2025/MM=05/DD=24/transaction_data.csv
[2025-05-24T22:02:09.237+0000] {subprocess.py:93} INFO - 25/05/24 22:02:09 WARN CSVHeaderChecker: CSV header does not conform to the schema.
[2025-05-24T22:02:09.237+0000] {subprocess.py:93} INFO -  Header: Transaction ID, Customer ID, Transaction Amount, Transaction Date, Payment Method, Product Category, Quantity, Customer Age, Customer Location, Device Used, IP Address, Shipping Address, Billing Address, Is Fraudulent, Account Age Days, Transaction Hour
[2025-05-24T22:02:09.238+0000] {subprocess.py:93} INFO -  Schema: Transaction_ID, Customer_ID, Transaction_Amount, Transaction_Date, Payment_Method, Product_Category, Quantity, Customer_Age, Customer_Location, Device_Used, IP_Address, Shipping_Address, Billing_Address, Is_Fraudulent, Account_Age_Days, Transaction_Hour
[2025-05-24T22:02:09.239+0000] {subprocess.py:93} INFO - Expected: Transaction_ID but found: Transaction ID
[2025-05-24T22:02:09.239+0000] {subprocess.py:93} INFO - CSV file: hdfs://namenode:9000/user/root/transactions/YYYY=2025/MM=05/DD=24/transaction_data.csv
[2025-05-24T22:02:10.263+0000] {subprocess.py:93} INFO - Spark session created successfully!
[2025-05-24T22:02:10.264+0000] {subprocess.py:93} INFO - Data loaded successfully. Row count: 23634
[2025-05-24T22:02:10.265+0000] {subprocess.py:93} INFO - Data saved to HDFS successfully!
[2025-05-24T22:02:10.755+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-05-24T22:02:10.785+0000] {taskinstance.py:1400} INFO - Marking task as SUCCESS. dag_id=fetch_transaction_data_and_upload_to_hdfs, task_id=run_spark_modelisation_command, execution_date=20250523T000000, start_date=20250524T220154, end_date=20250524T220210
[2025-05-24T22:02:10.814+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 0
[2025-05-24T22:02:10.844+0000] {taskinstance.py:2784} INFO - 1 downstream tasks scheduled from follow-on schedule check
