[2025-05-25T11:22:02.877+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: fetch_transaction_data_and_upload_to_hdfs.run_spark_modelisation_command scheduled__2025-05-24T00:00:00+00:00 [queued]>
[2025-05-25T11:22:02.885+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: fetch_transaction_data_and_upload_to_hdfs.run_spark_modelisation_command scheduled__2025-05-24T00:00:00+00:00 [queued]>
[2025-05-25T11:22:02.886+0000] {taskinstance.py:1361} INFO - Starting attempt 2 of 2
[2025-05-25T11:22:02.899+0000] {taskinstance.py:1382} INFO - Executing <Task(BashOperator): run_spark_modelisation_command> on 2025-05-24 00:00:00+00:00
[2025-05-25T11:22:02.905+0000] {standard_task_runner.py:57} INFO - Started process 669 to run task
[2025-05-25T11:22:02.911+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'fetch_transaction_data_and_upload_to_hdfs', 'run_spark_modelisation_command', 'scheduled__2025-05-24T00:00:00+00:00', '--job-id', '26', '--raw', '--subdir', 'DAGS_FOLDER/ETL.py', '--cfg-path', '/tmp/tmpx5ztfdsc']
[2025-05-25T11:22:02.916+0000] {standard_task_runner.py:85} INFO - Job 26: Subtask run_spark_modelisation_command
[2025-05-25T11:22:03.004+0000] {task_command.py:415} INFO - Running <TaskInstance: fetch_transaction_data_and_upload_to_hdfs.run_spark_modelisation_command scheduled__2025-05-24T00:00:00+00:00 [running]> on host 65b298c9af88
[2025-05-25T11:22:03.112+0000] {taskinstance.py:1660} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='fetch_transaction_data_and_upload_to_hdfs' AIRFLOW_CTX_TASK_ID='run_spark_modelisation_command' AIRFLOW_CTX_EXECUTION_DATE='2025-05-24T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-05-24T00:00:00+00:00'
[2025-05-25T11:22:03.115+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-05-25T11:22:03.116+0000] {subprocess.py:75} INFO - Running command: ['/bin/bash', '-c', 'docker exec spark-master python3 modelisation.py']
[2025-05-25T11:22:03.132+0000] {subprocess.py:86} INFO - Output:
[2025-05-25T11:22:05.774+0000] {subprocess.py:93} INFO - Setting default log level to "WARN".
[2025-05-25T11:22:05.775+0000] {subprocess.py:93} INFO - To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
[2025-05-25T11:22:06.155+0000] {subprocess.py:93} INFO - 25/05/25 11:22:06 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[2025-05-25T11:22:12.653+0000] {subprocess.py:93} INFO - [Stage 0:>                                                          (0 + 1) / 1]25/05/25 11:22:12 WARN CSVHeaderChecker: CSV header does not conform to the schema.
[2025-05-25T11:22:12.653+0000] {subprocess.py:93} INFO -  Header: Transaction ID, Customer ID, Transaction Amount, Transaction Date, Payment Method, Product Category, Quantity, Customer Age, Customer Location, Device Used, IP Address, Shipping Address, Billing Address, Is Fraudulent, Account Age Days, Transaction Hour
[2025-05-25T11:22:12.654+0000] {subprocess.py:93} INFO -  Schema: Transaction_ID, Customer_ID, Transaction_Amount, Transaction_Date, Payment_Method, Product_Category, Quantity, Customer_Age, Customer_Location, Device_Used, IP_Address, Shipping_Address, Billing_Address, Is_Fraudulent, Account_Age_Days, Transaction_Hour
[2025-05-25T11:22:12.655+0000] {subprocess.py:93} INFO - Expected: Transaction_ID but found: Transaction ID
[2025-05-25T11:22:12.655+0000] {subprocess.py:93} INFO - CSV file: hdfs://namenode:9000/user/root/transactions/YYYY=2025/MM=05/DD=25/transaction_data.csv
[2025-05-25T11:22:14.486+0000] {subprocess.py:93} INFO -                                                                                 25/05/25 11:22:14 WARN CSVHeaderChecker: CSV header does not conform to the schema.
[2025-05-25T11:22:14.487+0000] {subprocess.py:93} INFO -  Header: Transaction ID, Customer ID, Transaction Amount, Transaction Date, Payment Method, Product Category, Quantity, Customer Age, Customer Location, Device Used, IP Address, Shipping Address, Billing Address, Is Fraudulent, Account Age Days, Transaction Hour
[2025-05-25T11:22:14.488+0000] {subprocess.py:93} INFO -  Schema: Transaction_ID, Customer_ID, Transaction_Amount, Transaction_Date, Payment_Method, Product_Category, Quantity, Customer_Age, Customer_Location, Device_Used, IP_Address, Shipping_Address, Billing_Address, Is_Fraudulent, Account_Age_Days, Transaction_Hour
[2025-05-25T11:22:14.489+0000] {subprocess.py:93} INFO - Expected: Transaction_ID but found: Transaction ID
[2025-05-25T11:22:14.490+0000] {subprocess.py:93} INFO - CSV file: hdfs://namenode:9000/user/root/transactions/YYYY=2025/MM=05/DD=25/transaction_data.csv
[2025-05-25T11:22:14.554+0000] {subprocess.py:93} INFO - 25/05/25 11:22:14 WARN CSVHeaderChecker: CSV header does not conform to the schema.
[2025-05-25T11:22:14.554+0000] {subprocess.py:93} INFO -  Header: Transaction ID, Customer ID, Transaction Amount, Transaction Date, Payment Method, Product Category, Quantity, Customer Age, Customer Location, Device Used, IP Address, Shipping Address, Billing Address, Is Fraudulent, Account Age Days, Transaction Hour
[2025-05-25T11:22:14.555+0000] {subprocess.py:93} INFO -  Schema: Transaction_ID, Customer_ID, Transaction_Amount, Transaction_Date, Payment_Method, Product_Category, Quantity, Customer_Age, Customer_Location, Device_Used, IP_Address, Shipping_Address, Billing_Address, Is_Fraudulent, Account_Age_Days, Transaction_Hour
[2025-05-25T11:22:14.556+0000] {subprocess.py:93} INFO - Expected: Transaction_ID but found: Transaction ID
[2025-05-25T11:22:14.556+0000] {subprocess.py:93} INFO - CSV file: hdfs://namenode:9000/user/root/transactions/YYYY=2025/MM=05/DD=25/transaction_data.csv
[2025-05-25T11:22:14.683+0000] {subprocess.py:93} INFO - 25/05/25 11:22:14 WARN CSVHeaderChecker: CSV header does not conform to the schema.
[2025-05-25T11:22:14.684+0000] {subprocess.py:93} INFO -  Header: Transaction ID, Customer ID, Transaction Amount, Transaction Date, Payment Method, Product Category, Quantity, Customer Age, Customer Location, Device Used, IP Address, Shipping Address, Billing Address, Is Fraudulent, Account Age Days, Transaction Hour
[2025-05-25T11:22:14.685+0000] {subprocess.py:93} INFO -  Schema: Transaction_ID, Customer_ID, Transaction_Amount, Transaction_Date, Payment_Method, Product_Category, Quantity, Customer_Age, Customer_Location, Device_Used, IP_Address, Shipping_Address, Billing_Address, Is_Fraudulent, Account_Age_Days, Transaction_Hour
[2025-05-25T11:22:14.685+0000] {subprocess.py:93} INFO - Expected: Transaction_ID but found: Transaction ID
[2025-05-25T11:22:14.686+0000] {subprocess.py:93} INFO - CSV file: hdfs://namenode:9000/user/root/transactions/YYYY=2025/MM=05/DD=25/transaction_data.csv
[2025-05-25T11:22:17.244+0000] {subprocess.py:93} INFO - [Stage 3:>                  (0 + 1) / 1][Stage 4:>                  (0 + 1) / 1][Stage 3:>    (0 + 1) / 1][Stage 4:>    (0 + 1) / 1][Stage 5:>    (0 + 1) / 1]                                                                                25/05/25 11:22:17 WARN CSVHeaderChecker: CSV header does not conform to the schema.
[2025-05-25T11:22:17.245+0000] {subprocess.py:93} INFO -  Header: Transaction ID, Customer ID, Transaction Amount, Transaction Date, Payment Method, Product Category, Quantity, Customer Age, Customer Location, Device Used, IP Address, Shipping Address, Billing Address, Is Fraudulent, Account Age Days, Transaction Hour
[2025-05-25T11:22:17.245+0000] {subprocess.py:93} INFO -  Schema: Transaction_ID, Customer_ID, Transaction_Amount, Transaction_Date, Payment_Method, Product_Category, Quantity, Customer_Age, Customer_Location, Device_Used, IP_Address, Shipping_Address, Billing_Address, Is_Fraudulent, Account_Age_Days, Transaction_Hour
[2025-05-25T11:22:17.246+0000] {subprocess.py:93} INFO - Expected: Transaction_ID but found: Transaction ID
[2025-05-25T11:22:17.246+0000] {subprocess.py:93} INFO - CSV file: hdfs://namenode:9000/user/root/transactions/YYYY=2025/MM=05/DD=25/transaction_data.csv
[2025-05-25T11:22:20.486+0000] {subprocess.py:93} INFO - [Stage 12:>                                                         (0 + 1) / 1]                                                                                [Stage 13:>                                                         (0 + 1) / 1]25/05/25 11:22:20 WARN CSVHeaderChecker: CSV header does not conform to the schema.
[2025-05-25T11:22:20.488+0000] {subprocess.py:93} INFO -  Header: Transaction ID, Customer ID, Transaction Amount, Transaction Date, Payment Method, Product Category, Quantity, Customer Age, Customer Location, Device Used, IP Address, Shipping Address, Billing Address, Is Fraudulent, Account Age Days, Transaction Hour
[2025-05-25T11:22:20.490+0000] {subprocess.py:93} INFO -  Schema: Transaction_ID, Customer_ID, Transaction_Amount, Transaction_Date, Payment_Method, Product_Category, Quantity, Customer_Age, Customer_Location, Device_Used, IP_Address, Shipping_Address, Billing_Address, Is_Fraudulent, Account_Age_Days, Transaction_Hour
[2025-05-25T11:22:20.493+0000] {subprocess.py:93} INFO - Expected: Transaction_ID but found: Transaction ID
[2025-05-25T11:22:20.494+0000] {subprocess.py:93} INFO - CSV file: hdfs://namenode:9000/user/root/transactions/YYYY=2025/MM=05/DD=25/transaction_data.csv
[2025-05-25T11:22:21.348+0000] {subprocess.py:93} INFO - [Stage 15:>                                                         (0 + 1) / 1]                                                                                25/05/25 11:22:21 WARN CSVHeaderChecker: CSV header does not conform to the schema.
[2025-05-25T11:22:21.349+0000] {subprocess.py:93} INFO -  Header: Transaction ID, Customer ID, Transaction Amount, Transaction Date, Payment Method, Product Category, Quantity, Customer Age, Customer Location, Device Used, IP Address, Shipping Address, Billing Address, Is Fraudulent, Account Age Days, Transaction Hour
[2025-05-25T11:22:21.349+0000] {subprocess.py:93} INFO -  Schema: Transaction_ID, Customer_ID, Transaction_Amount, Transaction_Date, Payment_Method, Product_Category, Quantity, Customer_Age, Customer_Location, Device_Used, IP_Address, Shipping_Address, Billing_Address, Is_Fraudulent, Account_Age_Days, Transaction_Hour
[2025-05-25T11:22:21.349+0000] {subprocess.py:93} INFO - Expected: Transaction_ID but found: Transaction ID
[2025-05-25T11:22:21.350+0000] {subprocess.py:93} INFO - CSV file: hdfs://namenode:9000/user/root/transactions/YYYY=2025/MM=05/DD=25/transaction_data.csv
[2025-05-25T11:22:21.779+0000] {subprocess.py:93} INFO - 25/05/25 11:22:21 WARN CSVHeaderChecker: CSV header does not conform to the schema.
[2025-05-25T11:22:21.780+0000] {subprocess.py:93} INFO -  Header: Transaction ID, Customer ID, Transaction Amount, Transaction Date, Payment Method, Product Category, Quantity, Customer Age, Customer Location, Device Used, IP Address, Shipping Address, Billing Address, Is Fraudulent, Account Age Days, Transaction Hour
[2025-05-25T11:22:21.780+0000] {subprocess.py:93} INFO -  Schema: Transaction_ID, Customer_ID, Transaction_Amount, Transaction_Date, Payment_Method, Product_Category, Quantity, Customer_Age, Customer_Location, Device_Used, IP_Address, Shipping_Address, Billing_Address, Is_Fraudulent, Account_Age_Days, Transaction_Hour
[2025-05-25T11:22:21.781+0000] {subprocess.py:93} INFO - Expected: Transaction_ID but found: Transaction ID
[2025-05-25T11:22:21.781+0000] {subprocess.py:93} INFO - CSV file: hdfs://namenode:9000/user/root/transactions/YYYY=2025/MM=05/DD=25/transaction_data.csv
[2025-05-25T11:22:23.290+0000] {subprocess.py:93} INFO - [Stage 19:>                                                         (0 + 1) / 1]                                                                                25/05/25 11:22:23 WARN CSVHeaderChecker: CSV header does not conform to the schema.
[2025-05-25T11:22:23.290+0000] {subprocess.py:93} INFO -  Header: Transaction ID, Customer ID, Transaction Amount, Transaction Date, Payment Method, Product Category, Quantity, Customer Age, Customer Location, Device Used, IP Address, Shipping Address, Billing Address, Is Fraudulent, Account Age Days, Transaction Hour
[2025-05-25T11:22:23.291+0000] {subprocess.py:93} INFO -  Schema: Transaction_ID, Customer_ID, Transaction_Amount, Transaction_Date, Payment_Method, Product_Category, Quantity, Customer_Age, Customer_Location, Device_Used, IP_Address, Shipping_Address, Billing_Address, Is_Fraudulent, Account_Age_Days, Transaction_Hour
[2025-05-25T11:22:23.292+0000] {subprocess.py:93} INFO - Expected: Transaction_ID but found: Transaction ID
[2025-05-25T11:22:23.292+0000] {subprocess.py:93} INFO - CSV file: hdfs://namenode:9000/user/root/transactions/YYYY=2025/MM=05/DD=25/transaction_data.csv
[2025-05-25T11:22:25.330+0000] {subprocess.py:93} INFO - [Stage 22:>                                                         (0 + 1) / 1]                                                                                25/05/25 11:22:25 WARN CSVHeaderChecker: CSV header does not conform to the schema.
[2025-05-25T11:22:25.331+0000] {subprocess.py:93} INFO -  Header: Transaction ID, Customer ID, Transaction Amount, Transaction Date, Payment Method, Product Category, Quantity, Customer Age, Customer Location, Device Used, IP Address, Shipping Address, Billing Address, Is Fraudulent, Account Age Days, Transaction Hour
[2025-05-25T11:22:25.332+0000] {subprocess.py:93} INFO -  Schema: Transaction_ID, Customer_ID, Transaction_Amount, Transaction_Date, Payment_Method, Product_Category, Quantity, Customer_Age, Customer_Location, Device_Used, IP_Address, Shipping_Address, Billing_Address, Is_Fraudulent, Account_Age_Days, Transaction_Hour
[2025-05-25T11:22:25.333+0000] {subprocess.py:93} INFO - Expected: Transaction_ID but found: Transaction ID
[2025-05-25T11:22:25.334+0000] {subprocess.py:93} INFO - CSV file: hdfs://namenode:9000/user/root/transactions/YYYY=2025/MM=05/DD=25/transaction_data.csv
[2025-05-25T11:22:28.145+0000] {subprocess.py:93} INFO - [Stage 25:>                                                         (0 + 1) / 1][Stage 27:>                                                         (0 + 1) / 1]                                                                                Spark session created successfully!
[2025-05-25T11:22:28.146+0000] {subprocess.py:93} INFO - Data loaded successfully. Row count: 23634
[2025-05-25T11:22:28.147+0000] {subprocess.py:93} INFO - Data saved to HDFS successfully!
[2025-05-25T11:22:28.686+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-05-25T11:22:28.731+0000] {taskinstance.py:1400} INFO - Marking task as SUCCESS. dag_id=fetch_transaction_data_and_upload_to_hdfs, task_id=run_spark_modelisation_command, execution_date=20250524T000000, start_date=20250525T112202, end_date=20250525T112228
[2025-05-25T11:22:28.807+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 0
[2025-05-25T11:22:28.846+0000] {taskinstance.py:2784} INFO - 1 downstream tasks scheduled from follow-on schedule check
